\subsection{Teorema espectral para operadores compactos autoadjuntos.}

\begin{proposition}
  \label{prop:autoadj-real-eigenvalues} Si $T=T^*$ y  $Tv=\lambda v$ con $v\neq 0$, entonces $\lambda\in \mathbb{R}$. \end{proposition}

\begin{proof}
  $\lambda \dotp{v}{v} =
  \dotp{Tv}{v}=\dotp{v}{T^*v}=\dotp{v}{Tv}=\overline{\lambda}\dotp{v}{v}$. Como
  $v\neq 0$ se da $\lambda=\overline{\lambda}$.
\end{proof}

\begin{proposition}
  \label{prop:eigenspaces-finite-dim}
  Si $T$ es compacto, $\forall \lambda\neq 0$ se tiene que $Ker(T-\lambda Id)$
  es de dimensión finita.
\end{proposition}

\begin{proof}
  Si no es de dimensión finita, podemos tomar $(\phi_n)_n$ ortonormal e infinita
  en $Ker(T-\lambda Id)$ (espacio cerrado en un Hilbert, pues es preimagen de un
  $\{0\}$ por una función continua).

  Como $T$ es compacto, $(T\phi_n)_n$ debe tener una subsucesión convergente,
  pero como $T\phi_n=\lambda \phi_n$ $\forall n\in \mathbb{N}$,
  $\|T\phi_{n_j}-T\phi_{n_k}\|=|\lambda|\|\phi_{n_j}-\phi_{n_k}\|=\lambda\sqrt{2}
  $, así que ninguna subsucesión es de Cauchy, y no pueden ser convergentes.
\end{proof}

\begin{proposition}
  \label{prop:norm-eigenval}
  Si $T$ es un operador compacto y autoadjunto, entonces o bien $\|T\|$ o bien
  $-\|T\|$ es un valor propio.
\end{proposition}

\begin{proof}
  Sabemos que $\|T\|=\sup \{|\dotp{Tf}{f}|:\|f\|\le 1\}$ por ser $T=T^*$. La
  idea es encontrar un máximo.

  Tomo $(f_n)_n$ con $\|f_n\|\le 1$ y $\dotp{Tf_n}{f_n}\to \lambda$ para
  $|\lambda|=\|T\|$. Como $T$ es compacto, $(Tf_n)_n$ tiene una subsucesión
  $(Tf_{n_k})_k$ convergente en $H$, y llamo al límite $g\in H$.

  Afirmo entonces que $g$ es vector propio de $T$ con valor propio $\lambda$, lo
  que terminaría la prueba.
  \[
  0\le \|Tf_{n_k}-\lambda f_{n_k}\|^2 =
  \dotp{Tf_{n_k}}{Tf_{n_k}}-2\lambda\dotp{f_{n_k}}{Tf_{n_k}}+\lambda^2
  \dotp{f_{n_k}}{f_{n_k}}=
  \] 
  \[
  \|Tf_{n_k}\|^2-2\lambda\dotp{Tf_{n_k}}{f_{n_k}} + \lambda^2
  \underbrace{\|f_{n_k}\|^2}_{1}
  .\] 

  Tomando límites, por la continuidad de la norma:

  \[
  0\le \|g-\lambda \lim_{k \to \infty} f_{n_k}\|^2 \le 
  \|g\|^2-2\lambda\cdot \lambda + \lambda^2=0
  .\] 
  
  Se tiene entonces que $g=\lim_{k \to \infty} \lambda f_{n_k}$, y por lo tanto

  \[
  Tg = T(\lim_{k \to \infty} \lambda f_{n_k})=\lambda T(\lim_{k \to \infty}
  f_{n_k})=\lambda g
  ,\] 

  quedan demostrada la afirmación.

\end{proof}

\begin{remark}
  En $l^2$, el operador $T$ que actua $(\psi_n)_n\to (0,\psi_1,\psi_2,\ldots)$
  no es invertible (no es sobreyectiva), esto es, $T-0\cdot Id$ no es
  invertible, y sin embargo $0$ no es valor propio. Por eso el concepto de
  espectro es más general que el de valores propios, y por eso el teorema que
  dice que el espectro no es vacío no nos sirve para demostrar que existe un
  valor propio. En este contexto se introduce la siguiente notación.
\end{remark}

\begin{definition}
  Dado $T$ operador, llamamos $\sigma_p(T)$ al conjunto de los valores propios
  de $T$.
\end{definition}

\begin{theorem}[Hilbert-Schmidt]
  \label{th:hilbert-schmidt}
  Sea $H$ espacio de Hilbert separable, $T:H\to H$ un operador compacto y
  autoadjunto. Entonces existe una base hilbertiana $\{v_k\}_{k=1}^\infty$ de $H$ 
  con $Tv_k=\lambda_k v_k$ para $\lambda_k\in \mathbb{R}$ $\forall k=1,2,\ldots$ y
  $\lim_{k \to \infty} \lambda_k=0$.
\end{theorem}

\begin{proof}
  Llamo $S=\overline{span}\{v:v\text{ es vector propio de } T\}\subset H$.
  
  Afirmo que si $Ker T=\{0\} $ entonces $S=H$. Para demostrarlo, supongamos lo
  contrario, esto es, $S\neq H=S \oplus S^\bot$. $T(S)\subset S$
  claramente, así que si $g\in S^\bot$ entonces $\dotp{Tg}{f}=\dotp{g}{Tf}=0$ $\forall
  f\in S$, y por lo tanto $Tg\in S^\bot$. Puedo entonces considerar el operador
   $T|_{S^\bot}$ tiene un vector propio $v\in S^\bot$
   (\ref{prop:norm-eigenval}), que también lo será de $T$,
   contradicción\footnote{Creo que no se usa que sea inyectivo y que esto
   termina la prueba en el caso general.}.
  
  Si además $Tv_k=\lambda_k$ para $k=1,2,\ldots$ para $\{v_k\}_{k=1}^\infty $ 
  base hilbertiana, veamos que $\lim_{k \to \infty} \lambda_k=0$. Si no fuese
  así, existiría una subsucesión $(\lambda_{k_i})_i$ con $|\lambda_{k_i}|\ge
  \varepsilon$ $\forall i \in \mathbb{N}$. Se tiene entonces:

  \[
  \|\lambda_{k_i}v_{k_i}-\lambda_{k_j}v_{k_j}\|
  =\lambda_{k_i}^2+\lambda_{k_j}^2>2\cdot \varepsilon
  ,\] 

  y la sucesión $(TV_{k})_k$ no puede tener subsucesiones convergentes, que
  contradice que el operador sea compacto.

  Falta ver el caso no inyectivo. Si $KerT\neq 0$, como $H=KerT \oplus
  (KerT)^\bot$ y $KerT$ es el espacio propio asociado al valor propio $0$,
  aplicando el caso inyectivo a $T|_{(KerT)^\bot}$ ya lo tenemos, solo hay que
  ver que $Tg\in (KerT)^\bot$ para cada $g\in (KerT)^\bot$. Pero si $x\in KerT$,
  $\dotp{x}{Tg}=\dotp{Tx}{g}=\dotp{0}{g}=0$.
\end{proof}

\begin{remark}
  En ese caso $Tx=\sum_{n=1}^{\infty} \lambda_k\dotp{x}{v_k}v_k$ por ser el
  operador continuo.
\end{remark}

\begin{remark}
  $H=\oplus_{i=1}^\infty Ker(T-\lambda_i Id)$ con $\lambda_i\to 0$.
\end{remark}

\begin{definition}
  Un operador $T$ es normal si $T^*T=TT^*$.
\end{definition}

El teorema es cierto también para operadores normales, no hace falta que sean
autoadjuntos.

\begin{definition}
  Sea $T:H\to H$ operador, con $H$ Hilbert, y sean $b\in H$ y $\lambda\in
  \mathbb{K}-\{0\} $. Queremos encontrar $u\in H$ tal que $\lambda u-Tu=b$ (P).
  Llamamos problema homogéneo (P$_h$) al caso $b=0$.
\end{definition}

\begin{theorem}[Alternativa de Fredholm]
  \label{th:fredholm}
  Dado $T$ operador compacto y autoadjunto en un espacio $H$ de Hilbert
  separable, con base ortonormal $\{e_k\}_1^\infty$, entonces:
  \begin{enumerate}
    \item Si $\lambda\not\in \sigma_p(T) \cup \{0\} $, el problema (P) tiene una
      única solución dada por:
       \[
      u=\lambda^{-1}\left( b+ \sum_{n=1}^{\infty}
      \frac{\lambda_n}{\lambda-\lambda_n}\dotp{b}{e_n}e_n \right) 
      .\] 
    \item Si $\lambda \in \sigma_p(T)\setminus \{0\}$, entonces $(P)$ tiene
      solución si y solo si  $\dotp{b}{v}=0$ $\forall v$ solución de
      (P$_{\text{h}}$). En ese caso, si $\lambda=\lambda_i$, entonces las
      soluciones vienen dadas por:
       \[
      u=z+\lambda^{-1}\left(b+ \sum_{n=1,n\neq i}^{\infty}
      \frac{\lambda_n}{\lambda-\lambda_n}\dotp{b}{e_n}e_n \right) 
      ,\] 
      para $z$ solución de (P$_h$).
  \end{enumerate}
\end{theorem}

\begin{proof}\hfill
  \begin{enumerate}
    \item
      Por Hilbert-Schmidt (\ref{th:hilbert-schmidt}), existe una base
      $\{e_n\}_1^\infty$ base hilbertiana con $Te_n=\lambda_n e_n$ tal que
      $|\lambda_1|\ge |\lambda_2|\ge \ldots \to 0$.


      Supongamos que $u$ es solución de (P), observamos que
      \begin{align*}
        (\lambda-\lambda_n)\dotp{u}{e_n} &= \dotp{\lambda u}{e_n} - \dotp{u}{\bar{\lambda_n} e_n}\\
                                         &= \dotp{\lambda u}{e_n} - \dotp{u}{\lambda_n e_n}\\
                                         &= \dotp{\lambda Id u}{e_n} - \dotp{u}{Te_n}\\
                                         &= \dotp{\lambda Id u}{e_n} - \dotp{Tu}{e_n} \\
                                         &= \dotp{(\lambda Id - T) u}{e_n} \\
                                         &= \dotp{b}{e_n}
      .\end{align*}

      Como $\lambda\neq \lambda_n$ $\forall n\in N$:

      \[
      u=\lambda^{-1}(b+Tu)=
      \lambda^{-1}\left(b+\sum_{n=1}^{\infty} \lambda_n\dotp{u}{e_n}e_n\right)=
      \lambda^{-1}\left(b+\sum_{n=1}^{\infty}
      \frac{\lambda_n}{\lambda-\lambda_n}\dotp{b}{e_n}e_n\right)
      .\] 

      Considero $\alpha_n=\frac{\lambda_n}{\lambda-\lambda_n}$, y estudiemos la
      serie $\sum_{n=1}^{\infty} |\alpha_n|^2|\dotp{b}{e_n}|^2$. Como los
      $\lambda_n\to 0\neq \lambda$, $|\alpha_n|<C\in \mathbb{R}$ $\forall n\in
      \mathbb{N}$, y por lo tanto la serie queda acotada por $C^2\|b\|^2$ y
      converge, y dicho $u\in H$ existe. Además, por continuidad de $T$:

      \begin{align*}
        Tu &= \lambda^{-1}\left( Tb+\sum_{n=1}^{\infty} \alpha_n \lambda_n \dotp{b}{e_n}e_n \right)
           = \lambda^{-1}\left( \sum_{n=1}^{\infty} \lambda_n \dotp{b}{e_n}e_n + \sum_{n=1}^{\infty} \alpha_n \lambda_n \dotp{b}{e_n}e_n \right)\\
           &= \left( \sum_{n=1}^{\infty} \lambda^{-1}\lambda_n(1+\alpha_n) \dotp{b}{e_n}e_n \right)
           = \left( \sum_{n=1}^{\infty} \lambda^{-1}\lambda_n \frac{\lambda}{\lambda-\lambda_n} \dotp{b}{e_n}e_n \right)\\
           &= \left( \sum_{n=1}^{\infty} \frac{\lambda_n}{\lambda-\lambda_n} \dotp{b}{e_n}e_n \right)
      .\end{align*}

      Es obvio entonces que $u$ cumple la ecuación.

    \item Para la necesidad, sean $u,v$ soluciones de (P),(P$_h$)
      respectivamente. Como $\lambda\in \sigma_p(T)\subset \mathbb{R}$, $(\lambda
      Id-T)$ es autoadjunto, y por lo tanto:
      \[
      \dotp{b}{v}=
      \dotp{\lambda u - Tu}{v}=
      \dotp{\left( \lambda Id - T \right) u}{v}=
      \dotp{u}{\left( \lambda Id - T \right) v}=
      0
      .\] 

      Para la suficiencia, es evidente que si a una solución le sumas otra de la
      homogénea sigue siendo solución, así que bastará ver que la expresión con
      $z=0$ es solución. El argumento de convergencia y la comprobación de la
      igualdad se hacen exactamente igual que en el caso anterior, salvo por el
      siguiente detalle. $e_i$ es solución de la homogénea, así que al calcular
      $Tb$, el coeficiente i-ésimo
      $\dotp{Tb}{e_i}=\dotp{b}{Te_i}=\lambda_i\dotp{b}{e_i}=0$ no aparece.
  \end{enumerate}
\end{proof}

\begin{corollary}
  Fijado $\lambda\in \mathbb{K}-\{0\}$, si (P) tiene a lo más una solución
  $\forall  b\in H$, entonces se verifica que el operador lineal y continuo
  $(\lambda Id-T)^{-1}:H\to H$ queda bien definido. Además, la ecuación (P)
  tiene como solución $u=(\lambda Id-T)^{-1} b$.
\end{corollary}
